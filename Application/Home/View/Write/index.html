<?php

	$ip = GetHostByName($_SERVER['SERVER_NAME']);//获取本机IP
	require_once("http://".$ip.":8080/JavaBridge/java/Java.inc");//此行必须
	if(!empty($test)){
		$FileMakerCtrl = new Java("com.zhuozhengsoft.pageoffice.FileMakerCtrlPHP");//此行必须
		$FileMakerCtrl->setServerPage("http://".$ip.":8080/JavaBridge/poserver.zz");//此行必须，设置服务器页面

		java_set_file_encoding("GBK");//设置中文编码，若涉及到中文必须设置中文编码
		$id = $_SESSION['uid'];
		$filepath="/uteach/Word/doc/".$id."/".date('Ymd',time());
		//$filepath=dirname($_SERVER["SCRIPT_FILENAME"]);
		//$filepath .="/doc/".$id."/".date('Ymd',time());
		$type = $test;
		$doc = new Java("com.zhuozhengsoft.pageoffice.wordwriter.WordDocument");//声明WordDocument变量

		//禁用右击事件
		$doc->setDisableWindowRightClick(true);
		//给数据区域赋值，即把数据填充到模板中相应的位置
		//$doc->openDataRegion("PO_company")->setValue("北京卓正志远软件有限公司");
		$FileMakerCtrl->setSaveFilePage("/uteach/Word/SaveMaker.php?id=".$id."&type=".$type);
		$FileMakerCtrl->setWriter($doc);
		$FileMakerCtrl->setJsFunction_OnProgressComplete("OnProgressComplete()");
		$DocumentOpenType = new Java("com.zhuozhengsoft.pageoffice.DocumentOpenType");
		$FileMakerCtrl->fillDocument($filepath."/".$type.".doc", $DocumentOpenType->Word);
		echo $FileMakerCtrl->getDocumentView("FileMakerCtrl1");

	}

?>
<include file="Public:header"/>
<body style='background:##eaeaea'>
<table cellpadding="0" cellspacing="0" width="100%" style='background:#eaeaea' id="main">
	<tr>
		<include file="Public:left"/>

        <td id="index_right" style="" >
      
        <include file="Public:right"/>
     
		<iframe src="__APP__/home/Public/main_content.html" frameborder="1" style="width:100%;margin-top:-9px" id="right_bt"></iframe>   

			
      	</td>
    </tr>
</table>
<script language="javascript" type="text/javascript">
	function OnProgressComplete() {
		document.getElementById("FileMakerCtrl1").WebSaveAsHTML();
		//window.parent.myFunc(); //调用父页面的js函数
	}
	

</script>


</body>



</html>
